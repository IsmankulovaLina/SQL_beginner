## Exercise 00 — Простая агрегированная информация  
Давайте сделаем простую агрегацию, пожалуйста, напишите SQL-запрос, который возвращает идентификаторы людей и соответствующее количество посещений любых пиццерий, отсортированный по количеству посещений в порядке убывания и по `person_id` в порядке возрастания. Пожалуйста, посмотрите на пример данных ниже.  

| person_id | count_of_visits |  
| ------ | ------ |  
| 9 | 4 |  
| 4 | 3 |  
| ... | ... |  

## Exercise 01 — Давайте посмотрим реальные имена  
Пожалуйста, измените SQL-запрос из упражнения 00 и верните имя человека (а не идентификатор). Дополнительное условие — нужно показывать только топ-4 человека с максимальным количеством посещений в каждой пиццерии, отсортированных по имени человека. См. пример вывода данных ниже.  

| name | count_of_visits |  
| ------ | ------ |  
| Dmitriy | 4 |  
| Denis | 3 |  
| ... | ... |  

## Exercise 02 — Статистика ресторанов  
Пожалуйста, напишите SQL-запрос для отображения 3 самых популярных ресторанов по количеству посещений и заказов в списке (пожалуйста, добавьте колонку `action_type` со значениями `'order'` или `'visit'`, в зависимости от данных из соответствующей таблицы). Посмотрите на пример данных ниже. Результат должен быть отсортирован по возрастанию по `action_type` и по убыванию по `count`.  

| name | count | action_type |  
| ------ | ------ | ------ |  
| Dominos | 6 | order |  
| ... | ... | ... |  
| Dominos | 7 | visit |  
| ... | ... | ... |

## Exercise 03 — Статистика ресторанов #2  
Напишите SQL-запрос, чтобы показать, как рестораны сгруппированы по посещениям и заказам, и объединены по названию ресторана.  
Можно использовать внутренний SQL из упражнения 02 (Рестораны по посещениям и заказам) без ограничений по количеству строк.

Дополнительно добавьте следующие правила:  
- Посчитайте сумму заказов и посещений для соответствующей пиццерии (обратите внимание, что не все ключи пиццерий представлены в обеих таблицах).  
- Отсортируйте результаты по столбцу `total_count` по убыванию и по `name` по возрастанию. Посмотрите на пример данных ниже.  

| name       | total_count |
|------------|--------------|
| Dominos    | 13           |
| DinoPizza  | 9            |
| ...        | ...          |

## Exercise 04 — Ограничение для группировок  
Пожалуйста, напишите SQL-запрос, который возвращает имя человека и соответствующее число посещений любых пиццерий, если человек посетил их более чем 3 раза (>3). Пожалуйста, посмотрите на пример данных ниже. Без использования `WHERE`.  

| name     | count_of_visits |
|----------|-----------------|
| Dmitriy  | 4               |

## Exercise 05 — Уникальность человека  
Пожалуйста, напишите простой SQL-запрос, который возвращает список уникальных имен людей, сделавших заказы в любых пиццериях. Результат должен быть отсортирован по имени человека. Посмотрите на пример ниже. Без использования `GROUP BY`, любые операции (`UNION` и т.п.), работающие с множествами.  

| name     |
|----------|
| Andrey   |
| Anna     |
| ...      |

## Exercise 06 — Метрики ресторана  
Пожалуйста, напишите SQL-запрос, который возвращает количество заказов, среднюю цену, максимальную цену и минимальную цену для пицц, проданных каждым рестораном. Результат должен быть отсортирован по названию ресторана. Посмотрите на пример данных ниже. Округлите среднюю цену до двух знаков после запятой.  

| name       | count_of_orders | average_price | max_price | min_price |
|------------|-----------------|--------------:|----------:|----------:|
| Best Pizza   | 5               | 780           | 850       | 700       |
| DinoPizza    | 5               | 880           |1000       |800        |
| ...          | ...             | ...           |...        |...        |

## Exercise 07 — Средний глобальный рейтинг  
Напишите SQL-запрос, который возвращает общий средний рейтинг (имя атрибута результата — `global_rating`) для всех ресторанов. Округлите средний рейтинг до четырех знаков после запятой.

## Exercise 08 — Определение местоположения пиццерийных ресторанов  
Мы знаем личные адреса из наших данных. Предположим, что человек посещает только пиццерии в своем городе. Напишите SQL-запрос, который возвращает адрес, название пиццерии и количество заказов этого человека. Результат должен быть отсортирован сначала по адресу, затем по названию ресторана. Посмотрите на пример вывода данных ниже.

| address | name |count_of_orders |
| ------ | ------ |------ |
| Kazan | Best Pizza |4 |
| Kazan | DinoPizza |4 |
| ... | ... | ... | 


## Exercise 09 — Явное преобразование типа  
Пожалуйста, напишите SQL-запрос, который возвращает агрегированную информацию по адресу человека: результат "Максимальный возраст - (Минимальный возраст / Максимальный возраст)" представлен как колонка формулы; далее идет средний возраст по адресу; затем результат сравнения между формулой и средним значением (если формула больше среднего — True; иначе False).  

Результат должен быть отсортирован по колонке `address`. Посмотрите на пример вывода данных ниже.

| address | formula |average | comparison |
| ------ | ------ |------ |------ |
| Kazan | 44.71 |30.33 | true |
| Moscow | 20.24 | 18.5 | true |
| ... | ... | ... | ... |
